#!/usr/bin/env python3
"""
Script to fix UUID formats in seed_comprehensive_courses.sql
PostgreSQL UUID format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
"""

import re

def fix_uuid_in_file(filepath):
    with open(filepath, 'r') as f:
        content = f.read()
    
    # Pattern to match UUID-like strings that need fixing
    # Match: 'm1000001-0000-0000-0000-000000000001' -> '10000001-0000-0000-0000-000000000001'
    patterns = [
        (r"'m(\d+)-0000-0000-0000-00000000000(\d+)'", r"'\1-0000-0000-0000-00000000000\2'"),
        (r"'l(\d+)-0000-0000-0000-00000000000(\d+)'", r"'\1-0000-0000-0000-00000000000\2'"),
        (r"'v(\d+)-0000-0000-0000-00000000000(\d+)'", r"'\1-0000-0000-0000-00000000000\2'"),
    ]
    
    # Fix references without quotes
    ref_patterns = [
        (r"m1000001-0000-0000-0000-000000000001", "10000001-0000-0000-0000-000000000001"),
        (r"m1000001-0000-0000-0000-000000000002", "10000001-0000-0000-0000-000000000002"),
        (r"m1000001-0000-0000-0000-000000000003", "10000001-0000-0000-0000-000000000003"),
        (r"m1000001-0000-0000-0000-000000000004", "10000001-0000-0000-0000-000000000004"),
        (r"l1000001-0000-0000-0000-000000000001", "10000001-0000-0000-0000-000000000101"),
        (r"l1000001-0000-0000-0000-000000000002", "10000001-0000-0000-0000-000000000102"),
        (r"l1000001-0000-0000-0000-000000000003", "10000001-0000-0000-0000-000000000103"),
        (r"l1000001-0000-0000-0000-000000000004", "10000001-0000-0000-0000-000000000104"),
        (r"l1000001-0000-0000-0000-000000000005", "10000001-0000-0000-0000-000000000105"),
        (r"l1000001-0000-0000-0000-000000000006", "10000001-0000-0000-0000-000000000106"),
        (r"l1000001-0000-0000-0000-000000000007", "10000001-0000-0000-0000-000000000107"),
        (r"l1000001-0000-0000-0000-000000000008", "10000001-0000-0000-0000-000000000108"),
        (r"l1000001-0000-0000-0000-000000000009", "10000001-0000-0000-0000-000000000109"),
        (r"l1000001-0000-0000-0000-000000000010", "10000001-0000-0000-0000-000000000110"),
        (r"l1000001-0000-0000-0000-000000000011", "10000001-0000-0000-0000-000000000111"),
        (r"l1000001-0000-0000-0000-000000000012", "10000001-0000-0000-0000-000000000112"),
        (r"v1000001-0000-0000-0000-000000000001", "10000001-0000-0000-0000-000000000201"),
        (r"v1000001-0000-0000-0000-000000000002", "10000001-0000-0000-0000-000000000202"),
        (r"v1000001-0000-0000-0000-000000000003", "10000001-0000-0000-0000-000000000203"),
    ]
    
    # Apply all patterns
    for pattern, replacement in patterns:
        content = re.sub(pattern, replacement, content)
    
    for pattern, replacement in ref_patterns:
        content = content.replace(pattern, replacement)
    
    # Write back
    with open(filepath, 'w') as f:
        f.write(content)
    
    print("âœ… Fixed UUID formats in", filepath)

if __name__ == "__main__":
    fix_uuid_in_file("database/seed_comprehensive_courses.sql")




